(window.webpackJsonp=window.webpackJsonp||[]).push([[276],{309:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return d})),n.d(t,"metadata",(function(){return u})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return f}));var r=n(3),a=n(9),s=(n(0),n(410)),o=n(411),c=n(526),d={title:"Query 24h fees",tag:"test"},u={unversionedId:"24h-fees",id:"24h-fees",isDocsHomePage:!1,title:"Query 24h fees",description:"In order to get the 24h fees earned by RenVM, you'll need to fetch the current all-time fees, and the all-time fees from 24 hours ago, and subtract the two.",source:"@site/stats/24h-fees.mdx",slug:"/24h-fees",permalink:"/ren-client-docs/stats/24h-fees",editUrl:"https://github.com/renproject/ren-client-docs/edit/master/stats/24h-fees.mdx",version:"current",sidebar:"subgraph",previous:{title:"Darknode Stats",permalink:"/ren-client-docs/stats/darknode-stats"}},l=[],i={toc:l};function f(e){var t=e.components,n=Object(a.default)(e,["components"]);return Object(s.mdx)("wrapper",Object(r.default)({},i,n,{components:t,mdxType:"MDXLayout"}),Object(s.mdx)(o.DocTag,{type:o.DocType.HowTo,mdxType:"DocTag"}),Object(s.mdx)("p",null,"In order to get the 24h fees earned by RenVM, you'll need to fetch the current all-time fees, and the all-time fees from 24 hours ago, and subtract the two."),Object(s.mdx)("pre",null,Object(s.mdx)("code",{parentName:"pre",className:"language-ts"},"const currentTimestamp = Math.floor(Date.now() / 1000);\n> 1628130330\nconst previousTimestamp = currentTimestamp - (24 * 60 * 60)\n> 1628043930\n")),Object(s.mdx)(c.GraphQL,{url:"https://stats.renproject.io",defaultQuery:'{\n  current: Snapshot(timestamp: "1628130330") {\n    fees {\n      asset\n      amount\n    }\n    prices {\n      asset\n      priceInUsd\n      decimals\n    }\n  }\n  dayAgo: Snapshot(timestamp: "1628043930") {\n    fees {\n      asset\n      amount\n    }\n  }\n}',mdxType:"GraphQL"}),Object(s.mdx)("p",null,"You can then loop each asset to get the difference:"),Object(s.mdx)("pre",null,Object(s.mdx)("code",{parentName:"pre",className:"language-ts"},"// Get the fees collected as of 24 hours ago\nconst dayAgo = response.data.dayAgo.fees.reduce(\n  (acc, fees) => ({ ...acc, [fees.asset]: fees.amount }),\n  {}\n);\n\n// Get the current fees collected\nconst current = response.data.current.fees.reduce(\n  (acc, fees) => ({ ...acc, [fees.asset]: fees.amount }),\n  {}\n);\n\n// Get the latest prices\nconst prices = response.data.current.prices.reduce(\n  (acc, prices) => ({ ...acc, [prices.asset]: prices }),\n  {}\n);\n\nconst assets = Object.keys(current);\n\n// Sum up the difference for each asset, converted to USD.\nconst oneDayFees = assets.reduce((acc, asset) => {\n  const difference = current[asset] - (dayAgo[asset] || 0);\n  const differentInUsd =\n    (difference / 10 ** prices[asset].decimals) * prices[asset].priceInUsd;\n  return acc + (differentInUsd || 0);\n}, 0);\n\n// Print the sum in USD, with two decimals.\nconsole.log(oneDayFees.toFixed(2));\n")))}f.isMDXComponent=!0},411:function(e,t,n){"use strict";var r=n(4).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DocTag=t.DocType=void 0;var a,s,o=r(n(0));t.DocType=s,function(e){e.Tutorial="Tutorial",e.HowTo="How To",e.Reference="Reference",e.Explanation="Explanation"}(s||(t.DocType=s={}));var c=((a={})[s.Tutorial]="#b16bfc",a[s.HowTo]="#EC0088",a[s.Reference]="#ff823a",a[s.Explanation]="#29C0AF",a);t.DocTag=function(e){var t=e.type,n=e.marginBottom;return o.default.createElement(o.default.Fragment,null,o.default.createElement("span",{style:{border:"2px solid "+c[t]||!1,borderRadius:"5px",color:c[t]||"orange",padding:"0.1rem 0.4rem",marginBottom:void 0!==n?n:30,display:"inline-block"}},String(t)))}},526:function(e,t,n){"use strict";var r=n(4).default,a=n(19).default;Object.defineProperty(t,"__esModule",{value:!0}),t.GraphQL=void 0;var s=a(n(0)),o=r(n(729));n(370);var c=function(e){var t=e.url,r=e.defaultQuery,a=e.docExplorerOpen,o=e.minHeight;if("undefined"==typeof window)return null;var c=n(754).createGraphiQLFetcher,d=n(755).default,u=c({url:t});return s.default.createElement("div",{style:{height:o||500}},s.default.createElement(s.Suspense,{fallback:s.default.createElement("div",null,"Loading...")},s.default.createElement(d,{docExplorerOpen:a,query:r,fetcher:u})))};t.GraphQL=function(e){return"undefined"==typeof window?null:s.default.createElement(o.default,null,(function(){return s.default.createElement(s.default.Fragment,null,s.default.createElement(c,e),s.default.createElement("br",null))}))}}}]);