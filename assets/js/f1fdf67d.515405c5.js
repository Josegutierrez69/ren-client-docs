(window.webpackJsonp=window.webpackJsonp||[]).push([[276],{309:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return d})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return i}));var a=n(3),r=(n(0),n(410)),s=n(411),o=n(498);const c={title:"Query 24h fees",tag:"test"},d={unversionedId:"24h-fees",id:"24h-fees",isDocsHomePage:!1,title:"Query 24h fees",description:"In order to get the 24h fees earned by RenVM, you'll need to fetch the current all-time fees, and the all-time fees from 24 hours ago, and subtract the two.",source:"@site/stats/24h-fees.mdx",slug:"/24h-fees",permalink:"/ren-client-docs/stats/24h-fees",editUrl:"https://github.com/renproject/ren-client-docs/edit/master/stats/24h-fees.mdx",version:"current",sidebar:"subgraph",previous:{title:"Darknode Stats",permalink:"/ren-client-docs/stats/darknode-stats"}},l=[],u={toc:l};function i({components:e,...t}){return Object(r.mdx)("wrapper",Object(a.default)({},u,t,{components:e,mdxType:"MDXLayout"}),Object(r.mdx)(s.DocTag,{type:s.DocType.HowTo,mdxType:"DocTag"}),Object(r.mdx)("p",null,"In order to get the 24h fees earned by RenVM, you'll need to fetch the current all-time fees, and the all-time fees from 24 hours ago, and subtract the two."),Object(r.mdx)("pre",null,Object(r.mdx)("code",{parentName:"pre",className:"language-ts"},"const currentTimestamp = Math.floor(Date.now() / 1000);\n> 1628130330\nconst previousTimestamp = currentTimestamp - (24 * 60 * 60)\n> 1628043930\n")),Object(r.mdx)(o.GraphQL,{url:"https://stats.renproject.io",defaultQuery:'{\n  current: Snapshot(timestamp: "1628130330") {\n    fees {\n      asset\n      amount\n    }\n    prices {\n      asset\n      priceInUsd\n      decimals\n    }\n  }\n  dayAgo: Snapshot(timestamp: "1628043930") {\n    fees {\n      asset\n      amount\n    }\n  }\n}',mdxType:"GraphQL"}),Object(r.mdx)("p",null,"You can then loop each asset to get the difference:"),Object(r.mdx)("pre",null,Object(r.mdx)("code",{parentName:"pre",className:"language-ts"},"// Get the fees collected as of 24 hours ago\nconst dayAgo = response.data.dayAgo.fees.reduce(\n  (acc, fees) => ({ ...acc, [fees.asset]: fees.amount }),\n  {}\n);\n\n// Get the current fees collected\nconst current = response.data.current.fees.reduce(\n  (acc, fees) => ({ ...acc, [fees.asset]: fees.amount }),\n  {}\n);\n\n// Get the latest prices\nconst prices = response.data.current.prices.reduce(\n  (acc, prices) => ({ ...acc, [prices.asset]: prices }),\n  {}\n);\n\nconst assets = Object.keys(current);\n\n// Sum up the difference for each asset, converted to USD.\nconst oneDayFees = assets.reduce((acc, asset) => {\n  const difference = current[asset] - (dayAgo[asset] || 0);\n  const differentInUsd =\n    (difference / 10 ** prices[asset].decimals) * prices[asset].priceInUsd;\n  return acc + (differentInUsd || 0);\n}, 0);\n\n// Print the sum in USD, with two decimals.\nconsole.log(oneDayFees.toFixed(2));\n")))}i.isMDXComponent=!0},411:function(e,t,n){"use strict";var a=n(4).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DocTag=t.DocType=void 0;var r=a(n(0));let s;t.DocType=s,function(e){e.Tutorial="Tutorial",e.HowTo="How To",e.Reference="Reference",e.Explanation="Explanation"}(s||(t.DocType=s={}));const o={[s.Tutorial]:"#b16bfc",[s.HowTo]:"#EC0088",[s.Reference]:"#ff823a",[s.Explanation]:"#29C0AF"};t.DocTag=({type:e,marginBottom:t})=>r.default.createElement(r.default.Fragment,null,r.default.createElement("span",{style:{border:"2px solid "+o[e]||!1,borderRadius:"5px",color:o[e]||"orange",padding:"0.1rem 0.4rem",marginBottom:void 0!==t?t:30,display:"inline-block"}},String(e)))},498:function(e,t,n){"use strict";var a=n(4).default,r=n(19).default;Object.defineProperty(t,"__esModule",{value:!0}),t.GraphQL=void 0;var s=r(n(0)),o=a(n(662));n(370);const c=({url:e,defaultQuery:t,docExplorerOpen:a,minHeight:r})=>{if("undefined"==typeof window)return null;const{createGraphiQLFetcher:o}=n(687),c=n(688).default,d=o({url:e});return s.default.createElement("div",{style:{height:r||500}},s.default.createElement(s.Suspense,{fallback:s.default.createElement("div",null,"Loading...")},s.default.createElement(c,{docExplorerOpen:a,query:t,fetcher:d})))};t.GraphQL=e=>"undefined"==typeof window?null:s.default.createElement(o.default,null,(()=>s.default.createElement(s.default.Fragment,null,s.default.createElement(c,e),s.default.createElement("br",null))))}}]);